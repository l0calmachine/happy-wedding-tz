<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <div class="classic-audio-player">
            <audio id="classic-audio"></audio>
            <div class="controls">
                <button class="play-pause" title="Play/Pause">►</button>
                <button class="stop" title="Stop">■</button>
                <div class="time-display">0:00</div>
                <input type="range" class="seek-slider" value="0" max="100">
                <button class="mute" title="Mute">🔊</button><!-- U+1F50A + U+FE0E -->
            </div>
        </div>

        <img src="/images/cardstack-tz-trans.gif" alt="a hollerith punch card with a secret love letter to t+z" width="80%" id="hollerith">

        <p id="rotate-phone"><span class="arrow-rotate">⤻</span> rotate your phone<span class="arrow-rotate">⤺</span></p>

        <script>
    const audio = document.getElementById('classic-audio');
    
    audio.preload = "auto";
    audio.src = '/sound/landscape-with-a-fairy.mp3';
    audio.volume = 0.7;

    const playPauseBtn = document.querySelector('.play-pause');
    const stopBtn = document.querySelector('.stop');
    const muteBtn = document.querySelector('.mute');
    const seekSlider = document.querySelector('.seek-slider');
    const timeDisplay = document.querySelector('.time-display');

    playPauseBtn.addEventListener('click', async () => {
        if (audio.paused) {
            try {
                await audio.play();
                playPauseBtn.textContent = '❚❚';
            } catch (err) {
                console.log("Playback failed, trying muted:", err);
                audio.muted = true;
                await audio.play();
                audio.muted = false;
            }
        } else {
            audio.pause();
            playPauseBtn.textContent = '►';
        }
    });

        audio.addEventListener('canplay', () => {
            console.log("Audio is ready to play");
        });

        audio.addEventListener('error', () => {
            console.error("Audio error:", audio.error);
        });

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                playPauseBtn.click();
            }
        });

            stopBtn.addEventListener('click', () => {
            audio.pause();
            audio.currentTime = 0;
            playPauseBtn.textContent = '►';
            });

            muteBtn.addEventListener('click', () => {
            audio.muted = !audio.muted;
            muteBtn.textContent = audio.muted ? '🔇' : '🔊';
            });


            seekSlider.addEventListener('input', () => {
            const seekTime = audio.duration * (seekSlider.value / 100);
            audio.currentTime = seekTime;
            });

            audio.addEventListener('timeupdate', () => {
            if (audio.duration) {
                const value = (100 / audio.duration) * audio.currentTime;
                seekSlider.value = value;
                
                const minutes = Math.floor(audio.currentTime / 60);
                const seconds = Math.floor(audio.currentTime % 60);
                timeDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }
            });

            audio.addEventListener('ended', () => {
            playPauseBtn.textContent = '►';
            seekSlider.value = 0;
            });

                audio.addEventListener('canplay', () => {
        console.log("Audio is ready to play");
    });

    audio.addEventListener('error', () => {
        console.error("Audio error:", audio.error);
    });
        </script>
    </body>
</html>